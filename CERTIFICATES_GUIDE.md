# دليل نظام إدارة الشهادات

## نظرة عامة
تم إضافة نظام متكامل لإدارة شهادات الطلاب في نظام إدارة معلمي الحلقات. يتيح هذا النظام للمشرفين الفرعيين إضافة وتعديل الشهادات، بينما يمكن للمديرين متابعة وإدارة جميع الشهادات.

## المميزات الرئيسية

### للمشرف الفرعي
- ✅ **إضافة شهادة جديدة** مع جميع البيانات المطلوبة
- ✅ **تعديل الشهادة** خلال 24 ساعة من إنشائها
- ✅ **عرض قائمة الشهادات** التي أنشأها
- ✅ **عرض تفاصيل كل شهادة** بشكل كامل

### للمدير
- ✅ **عرض جميع الشهادات** في النظام
- ✅ **تعديل أي شهادة** بدون قيود زمنية
- ✅ **تغيير حالة الشهادة** من "جاري العمل" إلى "تمت"
- ✅ **إحصائيات شاملة** عن الشهادات
- ✅ **تصفية الشهادات** حسب الحالة

## البيانات المطلوبة للشهادة

1. **اسم الطالب** - النص الكامل لاسم الطالب
2. **الجنسية** - جنسية الطالب
3. **الجوال** - رقم الهاتف المحمول
4. **تاريخ الختمة المتوقع** - التاريخ المتوقع لإنهاء الختمة
5. **الرواية** - نوع الرواية (حفص عن عاصم، ورش عن نافع، إلخ)
6. **المقرأة أو الحلقات** - اسم المقرأة أو الحلقة
7. **نوع الختمة** - (تلاوة، حفظ، عرض ختمة، مراجعة، تجويد)
8. **اسم المعلم** - اسم المعلم المسؤول
9. **ملاحظات** (اختياري) - أي ملاحظات إضافية

## كيفية الاستخدام

### للمشرف الفرعي

#### إضافة شهادة جديدة
1. قم بتسجيل الدخول كمشرف فرعي
2. انتقل إلى لوحة التحكم
3. اضغط على "إدارة الشهادات"
4. اضغط على "إضافة شهادة جديدة"
5. املأ جميع الحقول المطلوبة
6. اضغط على "حفظ الشهادة"

#### تعديل شهادة
1. انتقل إلى صفحة "إدارة الشهادات"
2. اضغط على زر التعديل (✏️) بجانب الشهادة
3. عدل البيانات المطلوبة
4. اضغط على "حفظ التغييرات"

**⚠️ تنبيه:** يمكن التعديل فقط خلال 24 ساعة من إنشاء الشهادة

### للمدير

#### عرض جميع الشهادات
1. قم بتسجيل الدخول كمدير
2. انتقل إلى لوحة التحكم
3. اضغط على "إدارة الشهادات"
4. ستظهر لك جميع الشهادات مع الإحصائيات

#### تعديل شهادة
1. في صفحة إدارة الشهادات
2. اضغط على زر التعديل (✏️) بجانب الشهادة
3. عدل البيانات في النافذة المنبثقة
4. اضغط على "حفظ التغييرات"

#### تغيير حالة الشهادة
1. في صفحة إدارة الشهادات
2. اختر الحالة المطلوبة من القائمة المنسدلة في عمود "الحالة"
3. سيتم حفظ التغيير تلقائياً

#### تصفية الشهادات
استخدم الأزرار في أعلى الجدول:
- **الكل** - عرض جميع الشهادات
- **جاري العمل** - عرض الشهادات قيد التنفيذ فقط
- **المكتملة** - عرض الشهادات المكتملة فقط

## تحديث قاعدة البيانات

بعد تحديث الكود، يجب تحديث قاعدة البيانات لإضافة جدول الشهادات:

```bash
python update_db_certificates.py
```

أو باستخدام السكريبت العام:
```bash
python update_db.py
```

## الوصول السريع

### روابط المشرف الفرعي
- لوحة التحكم: `/supervisor/dashboard`
- إدارة الشهادات: `/certificates/manage`
- إضافة شهادة: `/certificates/add`
- تعديل شهادة: `/certificates/edit/<cert_id>`

### روابط المدير
- لوحة التحكم: `/admin/dashboard`
- إدارة الشهادات: `/certificates/admin/manage`

## الأمان والصلاحيات

- ✅ **المشرف الفرعي** يمكنه فقط رؤية وتعديل الشهادات التي أنشأها
- ✅ **التعديل محدود بـ 24 ساعة** للمشرف الفرعي
- ✅ **المدير** لديه صلاحيات كاملة على جميع الشهادات
- ✅ **تسجيل النشاطات** - جميع العمليات مسجلة في سجل النشاطات

## الملاحظات الفنية

### قاعدة البيانات
- اسم الجدول: `certificates`
- العلاقات: مرتبط بجدول `users` للمنشئ والمحدث

### الحالات المتاحة
1. **جاري العمل** - الحالة الافتراضية عند إنشاء الشهادة
2. **تمت** - عند اكتمال العمل على الشهادة

### التتبع
يتم تسجيل التالي لكل شهادة:
- من أنشأها (`created_by`)
- تاريخ الإنشاء (`created_at`)
- من عدلها (`updated_by`)
- تاريخ آخر تعديل (`updated_at`)

## الدعم والمساعدة

إذا واجهت أي مشاكل:
1. تأكد من تحديث قاعدة البيانات
2. تحقق من الصلاحيات
3. راجع سجل النشاطات

---

**تم التطوير بواسطة:** نظام إدارة معلمي الحلقات - مكة المكرمة  
**تاريخ الإصدار:** 2025-01-06
