#!/usr/bin/env python3
"""
ุณูุฑูุจุช ุชุญุถูุฑ ุงููุดุฑูุน ูููุดุฑ
"""

import os
import re

def check_personal_info():
    """ูุญุต ุงููููุงุช ููุชุฃูุฏ ูู ุนุฏู ูุฌูุฏ ูุนูููุงุช ุดุฎุตูุฉ"""
    
    print("๐ ูุญุต ุงููููุงุช ูููุนูููุงุช ุงูุดุฎุตูุฉ...")
    print()
    
    # ุฃููุงุท ุงูุจุญุซ ุนู ูุนูููุงุช ุญุณุงุณุฉ
    patterns = {
        'ุฃุฑูุงู ููุงุชู': r'\+966\d{9}|\d{10}',
        'ุจุฑูุฏ ุฅููุชุฑููู': r'\b[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.[A-Z|a-z]{2,}\b',
        'ุฃุฑูุงู ุจุทุงูุงุช': r'\d{16}',
    }
    
    # ุงููููุงุช ุงูุชู ูุฌุจ ูุญุตูุง
    files_to_check = []
    for root, dirs, files in os.walk('.'):
        # ุชุฌุงูู ุงููุฌูุฏุงุช
        dirs[:] = [d for d in dirs if d not in ['__pycache__', '.git', 'venv', 'env', 'static']]
        
        for file in files:
            if file.endswith(('.py', '.md', '.txt', '.html')):
                files_to_check.append(os.path.join(root, file))
    
    issues_found = False
    
    for filepath in files_to_check:
        try:
            with open(filepath, 'r', encoding='utf-8') as f:
                content = f.read()
                
                for pattern_name, pattern in patterns.items():
                    matches = re.findall(pattern, content)
                    if matches:
                        # ุงุณุชุซูุงุกุงุช ูุนุฑููุฉ (ุฃูุซูุฉ ูู ุงูููุฏ)
                        if '966' not in str(matches) or 'example' in filepath.lower():
                            continue
                        
                        print(f"โ๏ธ  {filepath}")
                        print(f"   ููุน: {pattern_name}")
                        print(f"   ุนุฏุฏ: {len(matches)}")
                        print()
                        issues_found = True
        except:
            pass
    
    if not issues_found:
        print("โ ูู ูุชู ุงูุนุซูุฑ ุนูู ูุนูููุงุช ุดุฎุตูุฉ ูุงุถุญุฉ")
    else:
        print("โ๏ธ  ุชุญุฐูุฑ: ุชู ุงูุนุซูุฑ ุนูู ูุนูููุงุช ูุญุชููุฉ")
        print("   ุงูุฑุฌุงุก ูุฑุงุฌุนุฉ ุงููููุงุช ุงููุฐููุฑุฉ")
    
    print()
    return not issues_found

def check_debug_mode():
    """ุงูุชุญูู ูู ุฃู DEBUG = False ูู ุงูุฅูุชุงุฌ"""
    print("๐ ูุญุต ุฅุนุฏุงุฏุงุช DEBUG...")
    
    try:
        with open('config.py', 'r', encoding='utf-8') as f:
            content = f.read()
            
            if 'DEBUG = True' in content:
                print("โ๏ธ  ุชุญุฐูุฑ: DEBUG = True ูู config.py")
                print("   ูุฌุจ ุชุบููุฑู ุฅูู DEBUG = False ูุจู ุงููุดุฑ")
                print()
                return False
            else:
                print("โ DEBUG = False")
                print()
                return True
    except:
        print("โ ูู ูุชู ุงูุนุซูุฑ ุนูู config.py")
        return False

def check_secret_key():
    """ุงูุชุญูู ูู ุฃู ุงูููุชุงุญ ุงูุณุฑู ููุณ ุงูุชุฑุงุถูุงู"""
    print("๐ ูุญุต ุงูููุชุงุญ ุงูุณุฑู...")
    
    try:
        with open('config.py', 'r', encoding='utf-8') as f:
            content = f.read()
            
            # ุงูููุงุชูุญ ุงูุถุนููุฉ
            weak_keys = [
                'dev',
                'test',
                'secret',
                'password',
                '123',
                'default'
            ]
            
            for key in weak_keys:
                if f"'{key}'" in content.lower() or f'"{key}"' in content.lower():
                    print("โ๏ธ  ุชุญุฐูุฑ: ุงูููุชุงุญ ุงูุณุฑู ูุจุฏู ุถุนููุงู")
                    print("   ูุฌุจ ุฅูุดุงุก ููุชุงุญ ุณุฑู ููู ูุจู ุงููุดุฑ")
                    print()
                    print("   ูุฅูุดุงุก ููุชุงุญ ููู:")
                    print("   >>> import secrets")
                    print("   >>> print(secrets.token_hex(32))")
                    print()
                    return False
            
            print("โ ุงูููุชุงุญ ุงูุณุฑู ูุจุฏู ุฌูุฏุงู")
            print()
            return True
    except:
        print("โ ูู ูุชู ุงูุนุซูุฑ ุนูู config.py")
        return False

def create_deployment_checklist():
    """ุฅูุดุงุก ูุงุฆูุฉ ุชุญูู ูููุดุฑ"""
    print("\n" + "="*60)
    print("๐ ูุงุฆูุฉ ุงูุชุญูู ูุจู ุงููุดุฑ")
    print("="*60)
    
    checklist = [
        "โ ุญุฐู ุจูุงูุงุช ุงูุงุฎุชุจุงุฑ (python delete_test_data.py)",
        "โ ุชุบููุฑ SECRET_KEY ูู config.py",
        "โ ุชุนููู DEBUG = False",
        "โ ุฅูุดุงุก ุญุณุงุจ ูุฏูุฑ ุฌุฏูุฏ",
        "โ ุชุบููุฑ ูููุฉ ูุฑูุฑ ุงููุฏูุฑ ุงูุงูุชุฑุงุถู",
        "โ ูุฑุงุฌุนุฉ .gitignore",
        "โ ุญุฐู ุงููููุงุช ุงูุฒุงุฆุฏุฉ",
        "โ ุงูุชุฃูุฏ ูู ุนุฏู ูุฌูุฏ ูุนูููุงุช ุดุฎุตูุฉ",
    ]
    
    for item in checklist:
        print(f"  {item}")
    
    print("\n" + "="*60)
    print()

def main():
    """ุชุดุบูู ุฌููุน ุงููุญูุตุงุช"""
    print("โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ")
    print("โ          ๐ ุชุญุถูุฑ ุงููุดุฑูุน ูููุดุฑ                          โ")
    print("โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ")
    print()
    
    all_ok = True
    
    # 1. ูุญุต ุงููุนูููุงุช ุงูุดุฎุตูุฉ
    if not check_personal_info():
        all_ok = False
    
    # 2. ูุญุต DEBUG
    if not check_debug_mode():
        all_ok = False
    
    # 3. ูุญุต ุงูููุชุงุญ ุงูุณุฑู
    if not check_secret_key():
        all_ok = False
    
    # 4. ุนุฑุถ ูุงุฆูุฉ ุงูุชุญูู
    create_deployment_checklist()
    
    # ุงููุชูุฌุฉ ุงูููุงุฆูุฉ
    if all_ok:
        print("โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ")
        print("โ            โ ุงููุดุฑูุน ุฌุงูุฒ ูููุดุฑ!                        โ")
        print("โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ")
        print()
        print("ุงูุฎุทูุงุช ุงูุชุงููุฉ:")
        print("1. ุฑุงุฌุน ููู DEPLOYMENT.md ููุชุนูููุงุช")
        print("2. ุงุฑูุน ุงููุดุฑูุน ุนูู GitHub")
        print("3. ุงูุดุฑู ุนูู PythonAnywhere")
        print()
    else:
        print("โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ")
        print("โ            โ๏ธ  ูุฌุจ ุฅุตูุงุญ ุงููุดุงูู ุฃููุงู                   โ")
        print("โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ")
        print()

if __name__ == '__main__':
    main()
