{% extends "base.html" %}

{% block content %}
<div class="container">
    <div class="row justify-content-center">
        <div class="col-md-8">
            <div class="card-islamic">
                <div class="card-header">
                    <i class="fas fa-book-open ms-2"></i>
                    تقديم طلب ختمة قاعدة النور
                </div>
                <div class="card-body">
                    <div class="alert alert-info">
                        <i class="fas fa-info-circle ms-2"></i>
                        يمكنك تقديم طلب ختمة قاعدة النور بدون تسجيل دخول. فقط أدخل رقم هويتك الوطنية وبيانات الطلب.
                    </div>

                    <form method="POST" action="{{ url_for('employee.qaida_noor_request') }}">
                        <div class="mb-3">
                            <label for="national_id" class="form-label">
                                <i class="fas fa-id-card ms-1"></i>
                                رقم هويتك الوطنية
                            </label>
                            <input type="text" class="form-control" id="national_id" name="national_id" required
                                maxlength="10" pattern="[0-9]{10}" placeholder="أدخل رقم الهوية (10 أرقام)">
                            <small class="form-text text-muted">يجب أن يكون رقم الهوية مكون من 10 أرقام</small>
                        </div>

                        <div class="mb-3">
                            <label for="student_name" class="form-label">
                                <i class="fas fa-user ms-1"></i>
                                اسم الطالب
                            </label>
                            <input type="text" class="form-control" id="student_name" name="student_name" required
                                placeholder="أدخل اسم الطالب">
                        </div>

                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="student_id" class="form-label">
                                    <i class="fas fa-id-badge ms-1"></i>
                                    رقم الطالب
                                </label>
                                <input type="text" class="form-control" id="student_id" name="student_id" required
                                    placeholder="أدخل رقم الطالب">
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="student_type" class="form-label">
                                    <i class="fas fa-user-tag ms-1"></i>
                                    نوع الطالب
                                </label>
                                <select class="form-select" id="student_type" name="student_type" required>
                                    <option value="" selected disabled>اختر نوع الطالب</option>
                                    <option value="دائم">دائم</option>
                                    <option value="زائر">زائر</option>
                                </select>
                            </div>
                        </div>


                        <div class="mb-3">
                            <label for="nationality" class="form-label">
                                <i class="fas fa-flag ms-1"></i>
                                الجنسية (الدولة)
                            </label>
                            <select class="form-select select2" id="nationality" name="nationality" required>
                                <option value="" selected disabled>اختر الدولة</option>
                                <option value="المملكة العربية السعودية">المملكة العربية السعودية</option>
                                <option value="مصر">مصر</option>
                                <option value="سوريا">سوريا</option>
                                <option value="المنطقة الشرقية">المنطقة الشرقية</option>
                                <option value="اليمن">اليمن</option>
                                <option value="السودان">السودان</option>
                                <option value="فلسطين">فلسطين</option>
                                <option value="الأردن">الأردن</option>
                                <option value="لبنان">لبنان</option>
                                <option value="العراق">العراق</option>
                                <option value="الكويت">الكويت</option>
                                <option value="البحرين">البحرين</option>
                                <option value="قطر">قطر</option>
                                <option value="الإمارات العربية المتحدة">الإمارات العربية المتحدة</option>
                                <option value="سلطنة عمان">سلطنة عمان</option>
                                <option value="المغرب">المغرب</option>
                                <option value="تونس">تونس</option>
                                <option value="الجزائر">الجزائر</option>
                                <option value="ليبيا">ليبيا</option>
                                <option value="موريتانيا">موريتانيا</option>
                                <option value="الصومال">الصومال</option>
                                <option value="جيبوتي">جيبوتي</option>
                                <option value="جزر القمر">جزر القمر</option>
                                <option value="باكستان">باكستان</option>
                                <option value="الهند">الهند</option>
                                <option value="بنغلاديش">بنغلاديش</option>
                                <option value="أفغانستان">أفغانستان</option>
                                <option value="إندونيسيا">إندونيسيا</option>
                                <option value="ماليزيا">ماليزيا</option>
                                <option value="الفلبين">الفلبين</option>
                                <option value="تايلاند">تايلاند</option>
                                <option value="سريلانكا">سريلانكا</option>
                                <option value="نيبال">نيبال</option>
                                <option value="تركيا">تركيا</option>
                                <option value="إيران">إيران</option>
                                <option value="بروناي">بروناي</option>
                                <option value="المالديف">المالديف</option>
                                <option value="ميانمار (بورما)">ميانمار (بورما)</option>
                                <option value="سنغافورة">سنغافورة</option>
                                <option value="فيتنام">فيتنام</option>
                                <option value="لاوس">لاوس</option>
                                <option value="كمبوديا">كمبوديا</option>
                                <option value="الصين">الصين</option>
                                <option value="اليابان">اليابان</option>
                                <option value="كوريا الجنوبية">كوريا الجنوبية</option>
                                <option value="كوريا الشمالية">كوريا الشمالية</option>
                                <option value="منغوليا">منغوليا</option>
                                <option value="تايوان">تايوان</option>
                                <option value="نيجيريا">نيجيريا</option>
                                <option value="تشاد">تشاد</option>
                                <option value="مالي">مالي</option>
                                <option value="السنغال">السنغال</option>
                                <option value="غانا">غانا</option>
                                <option value="إثيوبيا">إثيوبيا</option>
                                <option value="إريتريا">إريتريا</option>
                                <option value="تنزانيا">تنزانيا</option>
                                <option value="كينيا">كينيا</option>
                                <option value="أوغندا">أوغندا</option>
                                <option value="النيجر">النيجر</option>
                                <option value="الكاميرون">الكاميرون</option>
                                <option value="بوركينا فاسو">بوركينا فاسو</option>
                                <option value="غينيا">غينيا</option>
                                <option value="ساحل العاج">ساحل العاج</option>
                                <option value="جنوب أفريقيا">جنوب أفريقيا</option>
                                <option value="الولايات المتحدة الأمريكية">الولايات المتحدة الأمريكية</option>
                                <option value="كندا">كندا</option>
                                <option value="المكسيك">المكسيك</option>
                                <option value="البرازيل">البرازيل</option>
                                <option value="الأرجنتين">الأرجنتين</option>
                                <option value="فنزويلا">فنزويلا</option>
                                <option value="كولومبيا">كولومبيا</option>
                                <option value="تشيلي">تشيلي</option>
                                <option value="بيرو">بيرو</option>
                                <option value="المملكة المتحدة">المملكة المتحدة</option>
                                <option value="فرنسا">فرنسا</option>
                                <option value="ألمانيا">ألمانيا</option>
                                <option value="إيطاليا">إيطالي</option>
                                <option value="إسبانيا">إسبانيا</option>
                                <option value="البرتغال">البرتغال</option>
                                <option value="هولندا">هولندا</option>
                                <option value="بلجيكا">بلجيكا</option>
                                <option value="سويسرا">سويسرا</option>
                                <option value="النمسا">النمسا</option>
                                <option value="السويد">السويد</option>
                                <option value="النرويج">النرويج</option>
                                <option value="الدنمارك">الدنمارك</option>
                                <option value="فنلندا">فنلندا</option>
                                <option value="روسيا">روسيا</option>
                                <option value="أوكرانيا">أوكرانيا</option>
                                <option value="بولندا">بولندا</option>
                                <option value="رومانيا">رومانيا</option>
                                <option value="اليونان">اليونان</option>
                                <option value="قبرص">قبرص</option>
                                <option value="أستراليا">أستراليا</option>
                                <option value="نيوزيلندا">نيوزيلندا</option>
                                <option value="البوسنة والهرسك">البوسنة والهرسك</option>
                                <option value="ألبانيا">ألبانيا</option>
                                <option value="كوسوفو">كوسوفو</option>
                                <option value="مقدونيا">مقدونيا</option>
                                <option value="أخرى">أخرى</option>
                            </select>
                        </div>

                        <div class="mb-3">
                            <label for="request_date" class="form-label">
                                <i class="fas fa-calendar ms-1"></i>
                                تاريخ الختمة
                            </label>
                            <input type="date" class="form-control" id="request_date" name="request_date" required>
                        </div>

                        <div class="mb-3">
                            <label for="additional_info" class="form-label">
                                <i class="fas fa-comment ms-1"></i>
                                معلومات إضافية (اختياري)
                            </label>
                            <textarea class="form-control" id="additional_info" name="additional_info" rows="3"
                                placeholder="أي معلومات إضافية تود ذكرها"></textarea>
                        </div>

                        <div class="d-grid gap-2">
                            <button type="submit" class="btn btn-islamic btn-lg">
                                <i class="fas fa-paper-plane ms-1"></i>
                                تقديم الطلب
                            </button>
                            <a href="{{ url_for('index') }}" class="btn btn-islamic-outline">
                                <i class="fas fa-arrow-right ms-1"></i>
                                العودة للصفحة الرئيسية
                            </a>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>

{% endblock %}

{% block extra_css %}
<link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />
<style>
    /* تنسيق Select2 ليتوافق مع Bootstrap و RTL */
    .select2-container--default .select2-selection--single {
        height: 38px;
        border: 1px solid #dee2e6;
        border-radius: 0.375rem;
        padding-top: 5px;
    }

    .select2-container--default .select2-selection--single .select2-selection__arrow {
        height: 36px;
        left: 1px;
        right: auto;
    }

    .select2-container[dir="rtl"] .select2-selection--single .select2-selection__rendered {
        padding-right: 8px;
        padding-left: 20px;
    }
</style>
{% endblock %}

{% block extra_js %}
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
<script>
    // تعبئة رقم الهوية تلقائياً من آخر طلب
    document.addEventListener('DOMContentLoaded', function () {
        const lastNationalId = localStorage.getItem('emp_national_id');
        if (lastNationalId) {
            document.getElementById('national_id').value = lastNationalId;
        }

        // تعيين الحد الأدنى للتاريخ إلى اليوم
        const today = new Date().toISOString().split('T')[0];
        document.getElementById('request_date').setAttribute('min', today);
    });

    // تفعيل Select2
    $(document).ready(function () {
        $('.select2').select2({
            dir: "rtl",
            language: "ar",
            width: '100%',
            placeholder: 'اختر الجنسية'
        });
    });
</script>
{% endblock %}